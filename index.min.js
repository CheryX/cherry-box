function getTotalWidth(r,t,a,i=0){let l=0;return t.forEach(({text:t,font:e,modifier:o})=>{r.font=(o=null==o?"":o)+` ${a}px `+e,l+=r.measureText(t).width+i}),l-i}function getTotalHeight(o,t,r){let a="";t.forEach(({text:t,font:e})=>{o.font=r+"px "+e,a+=t});t=o.measureText(a);return t.actualBoundingBoxAscent+t.actualBoundingBoxDescent}function textBox(t,e,o,r,a,i,l,n=["middle","center"]){t.save();let f=getTotalWidth(t,i,l);f>r&&(l*=r/f);var x=getTotalHeight(t,i,l);f=getTotalWidth(t,i,l),"top"===n[0]&&(o+=x),"bottom"===n[0]&&(o+=a),"middle"===n[0]&&(o+=(x+a)/2),"center"===n[1]&&(e+=r/2-f/2),"right"===n[1]&&(e+=r-f),"left"===n[1]&&(e+=0),paintText(t,i,e,o,l),t.restore()}function wrapText(e,o,r,a,i,l,n="left"){e.save();let f=[],x=[],s=l/4;for(var h in i){var d=i[h].text.split(" ");let t=0;for(t in d){var T={color:i[h].color,text:d[t],font:i[h].font,modifier:i[h].modifier,shadow:i[h].shadow};a<getTotalWidth(e,x,l,s)+getTotalWidth(e,[T],l,s)+10&&(f.push(x),x=[]),x.push(T)}}for(var p in f.push(x),f){var u=getTotalWidth(e,f[p],l,s);let t=o;"center"===n&&(t+=a/2-u/2),"right"===n&&(t+=a-u),"left"===n&&(t+=0),"justify"===n&&(u=getTotalWidth(e,f[p],l),50<(s=(s=(a-u)/(f[p].length-1))<4?4:s)&&(s=10)),paintText(e,f[p],t,r+l*p+l,l,s)}e.restore()}function paintText(i,t,l,n,f,x=0){i.save(),t.forEach(({text:t,color:e,shadow:o,font:r,modifier:a})=>{i.fillStyle=e,i.font=(a=null==a?"":a)+` ${f}px `+r,o?(i.shadowColor=o.color,i.shadowOffsetX=o.offset[0]*f/100,i.shadowOffsetY=o.offset[1]*f/100,i.shadowBlur=o.blur):i.shadowColor="transparent",i.fillText(t,l,n),l+=i.measureText(t).width+x}),i.restore()}export{textBox,getTotalWidth,getTotalHeight,wrapText,paintText};